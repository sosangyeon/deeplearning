DETR 및 그 변형은 최근 몇 년 동안 정확한 물체 감지에 대한 큰 잠재력을 보여주었다.
개체 쿼리 메커니즘을 통해 DETR 제품군은 고정된 수의 개체 예측을 직접 얻고 감지 파이프라인을 간소화할 수 있다.
DECO는 백본과 컨볼루셔널 이코더-디코더 아키텍처로 구성된다. 
DECO 인코더를 신중하게 설계하고 DECO 디코더가 컨볼루셔널 레이어를 통해 객체 쿼리와 이미지 기능 간의 상호 작용을 수행할 수 있는 새로운 메커니즘을 제안한다. 

1. Introduction
객체 감지기는 대부분 컨볼루션 신경망을 기반으로 하며, 일반적으로 중복된 감지 결과를 제거하기 위한 후처리에 NMS전략이 사용된다. 
NMS 알고리즘:
단계 1: 먼저, 신뢰도 점수를 기준으로 모든 박스를 내림차순으로 정렬한다.
단계 2: 가장 높은 신뢰도 점수를 가진 박스를 선택하고, 이 박스와 겹치는 정도(보통 IoU, Intersection over Union 기준)를 계산한다.
단계 3: 겹침이 일정 임계값(예: 0.5) 이상인 다른 박스들은 제거하고, 남은 박스들에 대해 다시 반복한다.
단계 4: 이 과정을 반복하여 중복된 박스들이 제거된 최종 결과를 얻는다.
dnn 아키텍처의 발전은 물체 감지 작업에 도움이 되고 있다. 
예를 들어, 더 강력한 아키텍처는 일반적으로 탐지 성능을 상당히 향상시킨다. 최근 vit와 그 변형체의 등장은 이미지 분류 작업에서 탁월한 성능을 보여주었고,
물체 감지 분야의 견고한 기반을 구축했다.
DETR은 복잡한 NMS 후처리 모듈을 제거하고 쿼리 기반 엔트 두 엔드 개체 감지 파이프라인을 만들 수 있습니다.
한편, 강력한 성능을 재고하고 순수하 convnets도 적절한 아키텍처 설계를 통해 경쟁력 있는 성능을 달성할 수 있음을 보여준다. 
convnext는 정확도와 계산 비용 측면에서 swin transformer와 같은 비전 트랜스포머와 유리하게 경쟁한다. 
: 순수 convnets를 통해 쿼리 기반 end-to-end객체 검출기를 얻을 수 있으면서도 detr과 유사한 우수한 특성을 누릴 수 있는가?
deco 모델은 detr과 유사한 유리한 속성을 누리고 있다. 
객체 쿼리 메커니즘을 사용하여 deco는 고정된 객체 예측 세트를 직접 얻고 NMS 절차도 폐기한다.
또한 표준 컨볼루셔널 레이어로만 적층되어 있으며 정교한 어텐션 모듈에 의존하지 않는다. 
deco 인코더 및 디코더 아키텍처를 제안한다. deco 인코더는 conext 블록을 기반으로 하며, convnet은 입력 순열에 대한 변형이므로 위치 인코딩이 필요하지 않는다.
디코더는 객체 쿼리와 이미지 기능의 상호 작용을 가능하게 하는 detr 변형의 가장 필수적인 부분으로, 객체 쿼리가 최종 객체 예측을 수행하는데 필요한 정보를 캡처할 수 있다.
디코더의 일반적인 아키텍처를 추상화하여 self-interaction module과 cross interaction module의 두 가지 구성 요소로 나눈다. 
detr에서 sim 및 cim은 다중 헤드 자기 주의 및 교차 주의 메커니즘으로 구현되는 반면, 제안된 deco에서 sim은 단순 깊이 및 1x1 컨볼루션으로 쌓인다.
또한 deco가 컨볼루셔널 레이어를 통해 객체 쿼리와 이미지 기능 간의 상호 작용을 수행하고 간단한 업샘플링 및 풀링 작업을 수행할 수 있는 새로운 sim 메커니즘을 제안한다. 

2. Related Work
객체 감지는 기본적인 컴퓨터 비전 작업 중 하나이며 컴퓨터 비전 커뮤니티에서 많은 연구 관심을 끌었다.
faster rcnn은 가장 일반적인 2단계 물체 검출기 중 하나로, 먼저 지역 제안을 생성하고 최종 경계 상자 예측을 위해 지역 특징을 추출한다.
yolo시리즈와 같은 1단계 검출기는 이미지 특징에서 관심 대상을 직접 예측하여 검출 파이프라인을 단순화한다.
선구적인 작업인 detr은 트랜스포머 인코더 디코더 아키텍처를 활용하고 객체 감지를 집합 예측 문제로 모델링한다. 고정된 수의 물체를 직접 예측하고 수동으로 설계된 NMS의 필요성을 제거한다.
RT-DETR은 효율적인 멀티스케일 하이브리드 인코더와 IoU 인식 쿼리 선택을 제안하는 최초의 실시간 엔드 투 엔드 감지기

convnet 기반 엔드 투 엔드 검출기
detr 변형체와 같은 변압기 기반 검출기의 성공에 영감을 받은 여러 연구에서는 일대일 할당 전략과 예측 손실 설정을 도입하여 후처리 NMS를 제거하려고 시도한다.
onenet은 일대일 매칭에서 분류 비용의 중요성을 체계적으로 탐구하고 이를 retinanet 및 fcos와 같은 일반적인 convnet 기반 검출기에 적용한다.
defcn은 매칭 비용을 향상시키기 위해 라벨 할당의 새로운 전략을 도입한다. 
sparse rcnn은 고정된 수의 학습 가능한 앵커를 2단계 검출 파이프라인에 통합한다. 그러나 일종의 학습 가능한 행렬 곱셈인 dynamic head에 의해 쿼리 및 rol 기능과 상호 작용한다. 

3. Aproach
먼저 detr 모델을 다시 살펴보고 제안된 deco 프레임워크에 대한 개요를 제공한다. 
그런 다음 deco 인코더 및 디코더의 아키텍처 설계가 세부 사항으로 정교화된다. 

3.1 preliminary
detr은 먼저 백본을 사용하여 이미지 특징을 추출하고 이를 트랜스포머 인코더 및 디코더 아키텍처에 공급한다.
학습된 작은 개체 쿼리 집합은 전역 이미지 컨텍스트와 상호 작용하여 개체 예측의 최종 집합을 직접 출력한다.

3.2. Overall Framework of DECO
detr 기반 검출기의 가장 중요한 속성 중 하나는 최종 예측을 생성하기 위한 쿼리 기반 체계이다. 
이러한 방식으로 물체 감지기는 고정된 수의 물체를 직접 얻을 수 있으며 수동으로 설계된 NMS 후처리를 제거할 수 있다. 
deco는 cnn백본을 사용하여 입력 이미지에서 특징을 추출한다.
백본으로 feature map f를 추출하고, f는 인코더를 통해 f{enc}를 얻는다. cnn디코더는 f{enc}와 학습된 객체 쿼리의 고정된 수를 사용하여 
ffn을 통해 최종 감지 예측을 수행한다.

3.3. DECO Encoder
detr과 유사하게, 1x1 컨볼루션은 먼저 f의 채널 차원을 C에서 d로 줄이고 새로운 기능 맵 z를 얻는데 사용된다.
convnext는 depthwise 및 pointwise convolution을 사용하여 트랜스포머와 유사한 성능을 얻을 수 있음을 보여준다. 
따라서 convnext블록을 사용하여 deco 인코더를 구축한다.
detr에서 트랜스포머 아키텍처가 순열이 변하지 않기 때문에 각 트랜스포머 인코더 계층의 입력에 위치 인코딩을 추가해야 한다.
그러나 convnet아키텍처는 deco 인코더 레이어가 위치 인코딩을 제거할 수 있도록 순열 방향이다. 

3.4. DECO Decoder
작은 객체 쿼리 집합이 주어지면 detr의 디코더는 객체와 전역 이미지 기능 간의 관계를 추론하는 것을 목표로 한다.
detr 디코더의 각 계층은 주로 sim과 cim으로 구성된다.
이러한 방식으로 개체 쿼리는 전역 이미지 기능에 주의를 기울이고 예측된 각 개체에 대한 필수 정보를 캡처할 수 있다. 

Self-interaction module (SIM)
N개의 객체 쿼리가 주어지면 먼저 쿼리를 w{q}xh{q}xd로 재구성하고 컨볼루셔널 레이어에 공급한다.
예를 들어, N=100개의 객체 쿼리가 있는 경우 쿼리 임베딩은 10x10xd로 변형된다. 
여기서 longrange 지각 특징을 추출하기 위해 최대 9x9까지의 큰 커널 컨볼루션을 사용한다.

Cross-interaction module (CIM)
주로 인코더의 출력에서 이미지 기능 임베딩과 sim 부분에서 생성된 객체 쿼리 임베딩의 두 가지 기능을 입력으로 사용한다.
detr 디코더의 교차 어텐션 메커니즘을 사용하면 각 개체 쿼리가 이미지 기능과 상호 작용하여 개체 예측에 필요한 정보를 캡처할 수 있다.
그러나 convnets를 사용하여 이러한 종류의 상호 작용을 수행하는 것은 그리 직관적이지 않는다.
먼저 객체 쿼리를 업샘플링하여 z와 동일한 크기를 갖도록 한다.
그런 다음 업샘플링된 개체 쿼리와 이미지 기능 임베딩이 add작업을 사용하여 함께 융합된 다음 개체 쿼리가 이미지 기능에서 공간 정보를 캡처할 수 있도록 큰 커널 깊이별 컨볼루션이 뒤따른다.

3.5. DECO+
원래 detr과 deco의 한 가지 한계는 정확한 물체 감지에 중요한 것으로 입증된 멀티 스케일 기능이 없다는 것이다.
deformable detr은 멀티 스케일 deformable attention 모듈을 사용하여 멀티 스케일 기능을 집계하지만 이 메커니즘을 deco 프레임워크에 직접 적용할 수는 없다.
deco에 멀티 스케일 기능을 정착하기 위해 deco 인코더에서 향상된 글로벌 기능을 얻은 후 rt-detr에서 제안한 크로스 스케일 기능 융합 모듈을 사용한다.


