Abstract
객체 감지를 직접 집합 예측 문제로 보는 새로운 방법을 제시한다. 
우리의 접근 방식은 탐지 파이프라인을 간소화하여 작업에 대한 사전 지식을 명식적으로 인코딩하는 non-maximum suppression 
또는 앵커 생성과 같이 수동으로 설계된 많은 구성 요소의 필요성을 효과적으로 제거한다.
detection transformer라고 하는 새로운 프레임워크의 주요 구성 요소는 이분 매칭을 통해 고유한 예측을 강제하는 세트 기반 전역 손실과
트랜스포머 인코더-디코더 아키텍처이다.
bipartite matching 그래프 이론에서 두 개의 노드 집합이 있을 때, 한 집합의 노드와 다른 집합의 노드를 1:1로 연결하는 방법
DETR (DEtection TRansformer) 모델에서 이분 매칭은 모델의 예측 결과와 실제 라벨을 연결하는 데 사용된다.
모델의 예측과 실제 객체 라벨 사이에서 가장 최적의 매칭을 찾기 위해 이 방법이 사용된다.
학습된 작은 개체 쿼리 집합이 있는 경우 detr은 개체와 전역 이미지 컨텍스트의 관계를 고려하여 최종 예측 집합을 병렬로 직접 출력한다.

1. Introduction
개체 감지의 목표는 관심 있는 각 개체에 대한 경계 상자 및 범주 레이블 집합을 예측하는 것이다.
성능은 거의 중복된 예측을 축소하기 위한 후처리 단계, 앵커 세트의 설계 및 앵커에 대상자를 할당하는 휴리스틱에 의해 크게 영향을 받는다.
이러한 파이프라인을 단순화하기 위해 대리 작업을 우회하는 직접 집합 예측 접근 방식을 제안한다.
이러한 엔드 투 엔드 철학은 기계 번역 도는 음성 인식과 같은 복잡한 구조적 예측 작업에서 상당한 발전을 이루었지만 
객체 감지에서는 아직 그렇지 않다.
이전의 시도는 다른 형태의 사전 지식을 추가하거나 까다로운 벤치마크에서 강력한 기준선으로 경쟁력이 입증되지 않았다.

객체 감지를 직접 집합 예측 문제로 봄으로써 학습 파이프라인을 간소화한다. 
우리는 시퀀스 예측에 널리 사용되는 아키텍처 transformer를 기반으로 하는 인코더-디코더 아키텍처를 채택한다.
시퀀스의 요소 간의 모든 쌍별 상호 작용을 명시적으로 모델링하는 트랜스포머의 self-attention 메커니즘은 이러한 아키텍처를 중복 예측 제거와 같은 집합 예측의 특정 제약 조건에 특히 적합하게 만든다. 
detr은 모든 객체를 한 번에 예측하며, 예측된 객체와 실측 객체 간의 이분 일치를 수행하는 집합 손실 함수로 종단 간 훈련된다.

직접 집합 예측에 대한 대부분의 이전 작업과 비교할 때 detr의 주요 기능은 이분 매칭 손실 및 변환기와 병렬 디코딩의 결합이다.
우리의 matching loss function은 지상 실측 물체에 예측을 고유하게 할당하고 예측된 물체의 순열에 불변하므로 병렬로 방출할 수 있다.
faster rcnn보다 detr은 대형 물체에서 훨씬 더 나은 성능을 보여주며, 이는 트랜스포머의 non-locla 계산에 의해 가능했을 수 있는 결과이다.
그러나 작은 물체에서는 더 낮은 성능을 얻는다.

2 Related work

2.1 Set Prediction
집합을 직접 예측할 수 있는 표준 딥러닝 모델은 없다.
기본 집합 예측 작업은 다중 레이블 분류이며, 이에 대한 기준 접근 방식은 one-vs-rest 요소 사이에 기본 구조가 있는 감지와 같은 문제에 적용되지 않는다.
One-vs-Rest 접근 방식은 객체 탐지 문제에 적합하지 않다. 이유는 이 방식이 각 클래스에 대해 독립적으로 판단하기 때문에, 
객체 탐지와 같이 객체 간의 관계나 위치 정보가 중요한 문제에서는 정확한 예측을 하지 못할 수 있다. 
예를 들어, 동일한 위치에 여러 예측이 겹칠 수 있는 문제가 발생할 수 있다.
이러한 작업의 첫번째 어려움은 중복을 피하는 것이다.
대부분의 최신 검출기는 이 문제를 해결하기 위해 nms와 같은 후처리를 사용하지만, 직접 세트 예측은 후처리가 필요없다.
중복을 피하기 위해 예측된 모든 요소 간의 상호 작용을 모델링하는 전역 추론 체계가 필요하다.
상수 크기 집합 예측의 경우, 밀집된 완전 연결 네트워크로도 충분하지만 비용이 많이 든다. 
일반적인 접근 방식은 순환 신경망과 같은 auto-regressive 시퀀스 모델을 사용하는 것이다. 중복을 피하기 위해 예측된 모든 요소 간의 상호 작용을 모델링하는 전역 추론 체계가 필요하다.
모든 경우에 손실 함수는 예측의 순열에 의해 불변해야 한다. 
일반적인 해결책은 헝가리 알고리즘을 기반으로 손실을 설계하여 실측 자료와 예측 간의 이분 일치를 찾는 것이다. 
(객체 탐지 모델에서 예측된 결과와 실제 라벨(실측 자료)을 최적의 방식으로 매칭하기 위해 헝가리 알고리즘을 사용한다는 뜻
이렇게 하면 순열 불변성이 적용되고 각 대상 요소가 고유한 일치를 갖도록 보장한다. 
대부분의 이전 작업과 달리 auto-regressive 모델에서 벗어나 병렬 디코딩이 있는 트랜스포머를 사용한다.

2.2 transformers and parallel decoding
트랜스포머는 기계 번역을 위한 새로운 어텐션 기반 빌딩 블록으로 소개되어 있다.
어텐션 메커니즘은 전체 입력 시퀀스의 정보를 집계하는 신경망 계층이다.
트랜스포머는 non-local neural networks와 유사하게 시퀀스의 각 요소를 스캔하고 전체 시퀀스의 정보를 집계하여 업데이트하는 셀프 어텐션 레이어를 도입한다.
트랜스포머는 초기 seg2seg모델에 따라 자동 회귀 모델에 처음 사용되어 출력 토큰을 하나씩 생성했다.
그러나 엄청난 추론 비용으로 인해 오디오, 기계 번역, 단어 표현 학습, 그리고 최근에는 음성 인식 영역에서 병렬 시퀀스 생성이 개발되었다.
트랜스포머와 병렬 디코딩을 결합하여 계산 비용과 집합 예측에 필요한 전역 계산을 수행할 수 있는 능력 간의 적절한 절충안을 제공한다.

2.3 Object detection
2단계 검출기는 상자 제안을 예측하는 반면, 1단계 방법은 앵커 또는 가능한 물체 중심의 그리드를 예측한다.
최근 연구에 따르면 이러한 시스템의 최종 성능은 이러한 초기 추측이 설정되는 정확한 방식에 크게 좌우된다.
이 모델에서는 이러한 수작업 프로세스를 제거하고 앵커가 아닌 입력 이미지를 사용하여 절대 상자 예측을 사용하여 감지 집합을 직접 예측하여
감지 프로세스를 간소화할 수 있다.



